##########
# Garden #
##########
- id: garden_lounge_presence_on_motion
  alias: "[Garden Lounge] Presence On (Motion)"
  trigger:
    - entity_id: binary_sensor.garden_sensor_lounge_motion
      from: "off"
      platform: state
      to: "on"
  condition:
    - condition: state
      entity_id: binary_sensor.someone_home
      state: "on"
  action:
    - target:
        entity_id: input_boolean.presence_garden_lounge_motion
      service: input_boolean.turn_on

- id: garden_lounge_presence_off_motion
  alias: "[Garden Lounge] Presence Off (Motion)"
  trigger:
    - entity_id: binary_sensor.garden_sensor_lounge_motion
      from: "on"
      platform: state
      to: "off"
      for:
        minutes: 3
  condition:
    - condition: state
      entity_id: input_boolean.dnd_garden
      state: "off"
  action:
    - data:
        entity_id: input_boolean.presence_garden_lounge_motion
      service: input_boolean.turn_off

- id: garden_lounge_lights_on
  alias: "[Garden Lounge] Lights On"
  trigger:
    - entity_id: binary_sensor.presence_garden_lounge
      from: "off"
      platform: state
      to: "on"
  condition:
    - condition: state
      entity_id: sun.sun
      state: below_horizon
  action:
    - data_template:
        kelvin: "{{ state_attr('sensor.circadian_values', 'colortemp') | int }}"
        brightness_pct: "{{ state_attr('switch.circadian_lighting_garden', 'brightness') | int }}"
        transition: 3
      target:
        entity_id: light.garden_lounge
      service: light.turn_on
    - data_template:
        kelvin: "{{ state_attr('sensor.circadian_values', 'colortemp') | int }}"
        brightness_pct: "{{ state_attr('switch.circadian_lighting_garden', 'brightness') | int }}"
        transition: 3
      target:
        entity_id: light.garden_flower_beds
      service: light.turn_on

- id: garden_lounge_lights_off
  alias: "[Garden Lounge] Lights Off"
  trigger:
    - entity_id: binary_sensor.presence_garden_lounge
      from: "on"
      platform: state
      to: "off"
  action:
    - target:
        entity_id: light.garden_lounge
      service: light.turn_off
    - target:
        entity_id: light.garden_flower_beds
      service: light.turn_off

- id: garden_barbecue_presence_on_motion
  alias: "[Garden Barbecue] Presence On (Motion)"
  trigger:
    - entity_id: binary_sensor.garden_sensor_barbecue_motion
      from: "off"
      platform: state
      to: "on"
  condition:
    - condition: state
      entity_id: binary_sensor.someone_home
      state: "on"
  action:
    - target:
        entity_id: input_boolean.presence_garden_barbecue_motion
      service: input_boolean.turn_on

- id: garden_barbecue_presence_off_motion
  alias: "[Garden Barbecue] Presence Off (Motion)"
  trigger:
    - entity_id: binary_sensor.garden_sensor_barbecue_motion
      from: "on"
      platform: state
      to: "off"
      for:
        minutes: 3
  condition:
    - condition: state
      entity_id: input_boolean.dnd_garden
      state: "off"
  action:
    - data:
        entity_id: input_boolean.presence_garden_barbecue_motion
      service: input_boolean.turn_off

- id: garden_barbecue_lights_on
  alias: "[Garden Barbecue] Lights On"
  trigger:
    - entity_id: binary_sensor.presence_garden_barbecue
      from: "off"
      platform: state
      to: "on"
  condition:
    - condition: state
      entity_id: sun.sun
      state: below_horizon
  action:
    - data_template:
        kelvin: "{{ state_attr('sensor.circadian_values', 'colortemp') | int }}"
        brightness_pct: "{{ state_attr('switch.circadian_lighting_garden', 'brightness') | int }}"
        transition: 3
      target:
        entity_id: light.garden_barbecue
      service: light.turn_on
    - data_template:
        kelvin: "{{ state_attr('sensor.circadian_values', 'colortemp') | int }}"
        brightness_pct: "{{ state_attr('switch.circadian_lighting_garden', 'brightness') | int }}"
        transition: 3
      target:
        entity_id: light.garden_flower_bed
      service: light.turn_on

- id: garden_barbecue_lights_off
  alias: "[Garden Barbecue] Lights Off"
  trigger:
    - entity_id: binary_sensor.presence_garden_barbecue
      from: "on"
      platform: state
      to: "off"
  action:
    - target:
        entity_id: light.garden_barbecue
      service: light.turn_off
    - target:
        entity_id: light.garden_flower_bed
      service: light.turn_off